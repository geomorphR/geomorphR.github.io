<!DOCTYPE html>
<html lang="" xml:lang="">
  <head>
    <title>1: Morphometric Analysis</title>
    <meta charset="utf-8" />
    <meta name="author" content="" />
    <script src="01-IntroHistory_files/header-attrs-2.27/header-attrs.js"></script>
    <link rel="stylesheet" href="xaringan-themer.css" type="text/css" />
    <link rel="stylesheet" href="utilities.css" type="text/css" />
  </head>
  <body>
    <textarea id="source">
class: center, middle, inverse, title-slide

.title[
# 1: Morphometric Analysis
]
.subtitle[
## A Brief History and Data Types
]
.author[
### 
]

---




###  A Vision of Morphometrics 

“The study of form may be descriptive merely, or it may become analytical.  We begin by describing the shape of an object in simple words of common speech: we end by defining it in the precise language of mathematics; and the one method tends to follow the other in strict scientific order and historical continuity.”

###### D'Arcy Thompson. (1915). *Trans. Roy. Soc. Edinburgh*
---

### Morphology, Form, and Shape

+ Biologists have long quantified morphology, and done so in many ways 

&lt;img src="LectureData/01.Intro/MeasuringMorphology.png" width="80%" style="display: block; margin: auto;" /&gt;

+ These data types capture different aspects of morphology
+ Complexity `\(\uparrow\)` from L `\(\rightarrow\)` R, but not all characterize organismal shape *per se*
---

### Morphometrics

+ What is morphometrics?
+ From Greek: morpho (form) + metrikos (measure)
+ The quantification and analysis of morphological objects
+ Application of multivariate statistical analysis to the study of variation in plants and animals (Reyment, 1985)

  + The study of size and shape
  + The quantification of form (Lestrel, 2000)
  + **The study of shape variation and its covariation with other variables** (Bookstein, 1991)

+ This workshop is concerned with the quantification of shape as derived from landmark-based methods, and a proper evaluation of patterns of shape variation relative to explanatory variables

---

### Early Uses of Morphometrics

+ For centuries, biologists used descriptive morphology to compare organisms
+ Species taxonomy, classification, and ecological specialization were all addressed using anatomical properties
  + Plato &amp; Aristotle: believed that understanding form lead to understanding of function
  + Geothe: ‘morphology’ the form of an organism
+ Much early work was based on a vague notion of organismal form that lacked explicit definitions

---

### Morphometrics, Evolution, and Statistics

+ The development of morphometrics is intertwined with that of evolutionary biology and statistics

+ Based on observations of linear measurements, the **Biometric Tradition** of the late 1800s viewed most biological variation as continuous
  + Galton, Pearson, Fisher, etc. espoused this view and simultaneously developed biostatistical methods for summarizing patterns of biological variation: `\(\sigma^2\)`, `\(\rho\)`, `\(\chi^2\)`, `\(\beta\)`, etc.

--

+ In the `\(20^{th}\)` century, statistics and evolutionary biology continued to develop together
  + Fisher, Wright, Rao, Spearman and others derived statistical approaches to summarize patterns in biological data
  + ANOVA, variance partitioning, Discriminant Analysis, Principal Components, multivariate T-tests, Path Analysis, etc.  

--

+ These analytical advances paved the way for multivariate morphometric methods
  + However, analytical advances alone were not sufficient to advance our understanding of organismal form
  + Like any quantitative discipline, understanding *WHAT* one is characterizing (and how) is equally important, but was far from clear. This hampered meaningful biological inference!
  
---

### Form and Shape

+ Historically, form and shape were used interchangeably, but there is a distinction:

  + Over the past 50 years, a more formal distinction has emerged: 

  + `Form = size + shape`

+ **This requires a definition of shape:**

--

  + Shape: The geometric properties of an object that are invariant to changes in translation, rotation, and scale (Bookstein 1991); Dryden and Mardia (1998)

  + or Shape: The variation that remains once position, orientation, and scale have been mathematically held constant

+ That is all fine and dandy, but how do we make this operational?

+ What, exactly do we quantify?

---

### Quantifying Shape

**Morphometrics: the study of shape variation and its covariation**

+ The Problem:  There are no *natural* units for shape

  + Use a set of proxy variables to represent shape (morphometric traits)
  + Different approaches use different types of variables and methodologies to obtain them

**The Data should**

  + Register shape in a repeatable manner and archive it for statistical analyses
  + Contain enough information to reconstruct a graphical representation of the structure of interest
  + Be appropriate to address the biological question of interest
---

### Morphometric Data

+ Morphometric data may quantify:

  + The location of discrete anatomic features (**points**)
  + Distances between anatomic features (**lines**)
  + Outlines of a structure (**curves**)
  + The surface of a structure (**surfaces**)

+ The modern morphometric synthesis permits the combination of ALL these types of data (via landmarks and semilandmarks)
---

### Homology in Morphometrics

+ Data must quantify shape in a repeatable manner

+ Homology: correspondence across specimens

  + Evolutionary homology: structures derived from the same tissue of the most recent common ancestor
  + Operational homology: correspondence in the position of structures

+ In Morphometrics, we may use both, depending on the question being addressed
+ The important point is to obtain **repeatable** data across observations
---

### Data Types: Linear Measurements

+ Use linear measurements, angles, etc., between anatomic features, or structures (e.g. head width)
+ Use some method to eliminate non-shape variation (size)
+ Analyze the data using multivariate statistics
+ aka 'traditional' or “multivariate” morphometrics

&lt;img src="LectureData/01.Intro/LizardMultiMorph.png" width="80%" style="display: block; margin: auto;" /&gt;
---

### Linear Measurements: Considerations

+ **Advantages**

  + Allow comparison to previous studies
  + The variables used are very intuitive and easy to interpret biologically
  
+ **Disadvantages**

  + Size is a latent factor and there is no global consensus on how to account for it – different approaches provide different results
  + The same values may represent different shapes
  + Homology is difficult to evaluate and guarantee
  + Usually it is difficult to obtain a graphical representation of variation in shape (because the geometry of the structure is not preserved in the analysis)
---

### Linear Measures: Same Values Different Shapes

&lt;img src="LectureData/01.Intro/SkullMeas.png" width="80%" style="display: block; margin: auto;" /&gt;

&lt;img src="LectureData/01.Intro/SameMeasures.png" width="30%" style="display: block; margin: auto;" /&gt;

Something is missing! The relative positions of the distances on the structure
---

### Historical Side-Note: The Truss

+ An interconnected network of distance measurements between anatomical points
+ The truss was an effort to maintain the relative positions between traits
+ Can provide a graphical representation

&lt;img src="LectureData/01.Intro/Truss.png" width="60%" style="display: block; margin: auto;" /&gt;

+ However, statistical treatment was problematic
  + Measurements partially redundant (thus, resulting covariance matrices singular)
  + Mean shapes were not always physically realizable (e.g., needed to 'flatten' the truss)
---

### The Morphometric Revolution

+ In the 1980s, there is a radical shift in methodology

  + Linear measurements do not capture all of the properties required to describe shape, but their endpoints did
  + Thus, use landmark coordinates as the raw data

+ From this **Geometric Morphometric Methods (GMM) emerged**

+ This advance was aided by the simultaneous development of mathematical shape theory

&lt;img src="LectureData/01.Intro/PlethHeadLand.png" width="50%" style="display: block; margin: auto;" /&gt;
---

### Landmark Coordinates

+ Use x, y (or x, y, z) coordinates of anatomic locations to quantify anatomical variation
+ Eliminate non-shape variation (size and others, see further on)
+ Multivariate data analysis

&lt;img src="LectureData/01.Intro/LandLIzard.png" width="50%" style="display: block; margin: auto;" /&gt;

+ 'Landmarks are the points at which one’s explanations of biological processes are grounded.'  Bookstein (1990)
---

### Types of Landmarks

&lt;img src="LectureData/01.Intro/LandmarkTypes.png" width="70%" style="display: block; margin: auto;" /&gt;
---

### Data Types: Curves

+ Quantify a biological curve via a mathematical function (polynomials, Bezier, Fourier, etc.)
    + **Partial Curves**: different starting and ending points
    + **Complete Curves**: the starting and ending point coincide (closed curves)

&lt;img src="LectureData/01.Intro/Curves.png" width="60%" style="display: block; margin: auto;" /&gt;

+ **Advantage**   
  + Useful when there are few or no landmarks
  
+ **Disadvantages**   
  + Homology difficult to assess
  + Alternative analytical summaries can lead to differing biological conclusions 
---

### Semilandmarks

+ Semilandmarks are used to quantify anatomical curves and surfaces

+ Can be quantified on curves (2D) or surfaces (3D)

+ They are treated as “degenerate” landmarks, the position of which is limited to slide on a curve (or surface) during analysis

+ Only variation orthogonal (perpendicular) to the curve is relevant

&lt;img src="LectureData/01.Intro/Semilandmarks.png" width="60%" style="display: block; margin: auto;" /&gt;
---

### The Procrustes Paradigm

.pull-left[
+ Combining landmarks and semilandmarks there is a general solution for quantifying biological shape variation

+ We obtain quantitative information that represents:
    + Discrete anatomical points
    + Curves (outlines) of structures
    + Surfaces of structures

+ We can combine it all in a single analysis!

]

.pull-right[
&lt;img src="LectureData/01.Intro/Friess.png" width="75%" style="display: block; margin: auto;" /&gt;
]
---

### General Morphometric Protocol

&lt;img src="LectureData/01.Intro/GenGMProtocol.png" width="70%" style="display: block; margin: auto;" /&gt;
---

### Special Considerations: Missing Data

+ Sometimes landmarks are missing
+ Methods to estimate their location exist (discussed later this week)

&lt;img src="LectureData/01.Intro/Missing.png" width="80%" style="display: block; margin: auto;" /&gt;
---

### Special Considerations: Symmetry

+ Sometimes objects display symmetry
+ GMM procedures adjusted slightly for this  (discussed later this week)

&lt;img src="LectureData/01.Intro/Symmetry.png" width="80%" style="display: block; margin: auto;" /&gt;
---

### Dean's View of Quantitative Biology

+ Methods are a product of theory and data type
+ Choose methods that are mathematically sound, but also theoretically and biologically sound

+ METHODS SHOULD NOT INTRODUCE PATTERNS!!!!


    </textarea>
<style data-target="print-only">@media screen {.remark-slide-container{display:block;}.remark-slide-scaler{box-shadow:none;}}</style>
<script src="https://remarkjs.com/downloads/remark-latest.min.js"></script>
<script>var slideshow = remark.create({
"highlightStyle": "solarized-light",
"highlightLines": true,
"countIncrementalSlides": false,
"ratio": "16:9",
"self_contained": false
});
if (window.HTMLWidgets) slideshow.on('afterShowSlide', function (slide) {
  window.dispatchEvent(new Event('resize'));
});
(function(d) {
  var s = d.createElement("style"), r = d.querySelector(".remark-slide-scaler");
  if (!r) return;
  s.type = "text/css"; s.innerHTML = "@page {size: " + r.style.width + " " + r.style.height +"; }";
  d.head.appendChild(s);
})(document);

(function(d) {
  var el = d.getElementsByClassName("remark-slides-area");
  if (!el) return;
  var slide, slides = slideshow.getSlides(), els = el[0].children;
  for (var i = 1; i < slides.length; i++) {
    slide = slides[i];
    if (slide.properties.continued === "true" || slide.properties.count === "false") {
      els[i - 1].className += ' has-continuation';
    }
  }
  var s = d.createElement("style");
  s.type = "text/css"; s.innerHTML = "@media print { .has-continuation { display: none; } }";
  d.head.appendChild(s);
})(document);
// delete the temporary CSS (for displaying all slides initially) when the user
// starts to view slides
(function() {
  var deleted = false;
  slideshow.on('beforeShowSlide', function(slide) {
    if (deleted) return;
    var sheets = document.styleSheets, node;
    for (var i = 0; i < sheets.length; i++) {
      node = sheets[i].ownerNode;
      if (node.dataset["target"] !== "print-only") continue;
      node.parentNode.removeChild(node);
    }
    deleted = true;
  });
})();
// add `data-at-shortcutkeys` attribute to <body> to resolve conflicts with JAWS
// screen reader (see PR #262)
(function(d) {
  let res = {};
  d.querySelectorAll('.remark-help-content table tr').forEach(tr => {
    const t = tr.querySelector('td:nth-child(2)').innerText;
    tr.querySelectorAll('td:first-child .key').forEach(key => {
      const k = key.innerText;
      if (/^[a-z]$/.test(k)) res[k] = t;  // must be a single letter (key)
    });
  });
  d.body.setAttribute('data-at-shortcutkeys', JSON.stringify(res));
})(document);
(function() {
  "use strict"
  // Replace <script> tags in slides area to make them executable
  var scripts = document.querySelectorAll(
    '.remark-slides-area .remark-slide-container script'
  );
  if (!scripts.length) return;
  for (var i = 0; i < scripts.length; i++) {
    var s = document.createElement('script');
    var code = document.createTextNode(scripts[i].textContent);
    s.appendChild(code);
    var scriptAttrs = scripts[i].attributes;
    for (var j = 0; j < scriptAttrs.length; j++) {
      s.setAttribute(scriptAttrs[j].name, scriptAttrs[j].value);
    }
    scripts[i].parentElement.replaceChild(s, scripts[i]);
  }
})();
(function() {
  var links = document.getElementsByTagName('a');
  for (var i = 0; i < links.length; i++) {
    if (/^(https?:)?\/\//.test(links[i].getAttribute('href'))) {
      links[i].target = '_blank';
    }
  }
})();
// adds .remark-code-has-line-highlighted class to <pre> parent elements
// of code chunks containing highlighted lines with class .remark-code-line-highlighted
(function(d) {
  const hlines = d.querySelectorAll('.remark-code-line-highlighted');
  const preParents = [];
  const findPreParent = function(line, p = 0) {
    if (p > 1) return null; // traverse up no further than grandparent
    const el = line.parentElement;
    return el.tagName === "PRE" ? el : findPreParent(el, ++p);
  };

  for (let line of hlines) {
    let pre = findPreParent(line);
    if (pre && !preParents.includes(pre)) preParents.push(pre);
  }
  preParents.forEach(p => p.classList.add("remark-code-has-line-highlighted"));
})(document);</script>

<script>
slideshow._releaseMath = function(el) {
  var i, text, code, codes = el.getElementsByTagName('code');
  for (i = 0; i < codes.length;) {
    code = codes[i];
    if (code.parentNode.tagName !== 'PRE' && code.childElementCount === 0) {
      text = code.textContent;
      if (/^\\\((.|\s)+\\\)$/.test(text) || /^\\\[(.|\s)+\\\]$/.test(text) ||
          /^\$\$(.|\s)+\$\$$/.test(text) ||
          /^\\begin\{([^}]+)\}(.|\s)+\\end\{[^}]+\}$/.test(text)) {
        code.outerHTML = code.innerHTML;  // remove <code></code>
        continue;
      }
    }
    i++;
  }
};
slideshow._releaseMath(document);
</script>
<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
(function () {
  var script = document.createElement('script');
  script.type = 'text/javascript';
  script.src  = 'https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML';
  if (location.protocol !== 'file:' && /^https?:/.test(script.src))
    script.src  = script.src.replace(/^https?:/, '');
  document.getElementsByTagName('head')[0].appendChild(script);
})();
</script>
  </body>
</html>
